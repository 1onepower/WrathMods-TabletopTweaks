using Kingmaker.Blueprints;
using Kingmaker.Blueprints.Classes.Selection;
using TabletopTweaks.Config;
using TabletopTweaks.Extensions;
using TabletopTweaks.Utilities;

namespace TabletopTweaks.NewContent.ArcanistExploits {
    static class MetamagicKnowledge {
        public static void AddMetamagicKnowledge() {
            //Used Assets
            var ArcanistExploitSelection = Resources.GetBlueprint<BlueprintFeatureSelection>("b8bf3d5023f2d8c428fdf6438cecaea7");
            var ShamanHexSecretSelection = Resources.GetBlueprint<BlueprintFeatureSelection>("1342b5bfb876e434797cdcf7311bccad");

            var ArcanistExploitMetamagicKnowledge = Helpers.Create<BlueprintFeatureSelection>(bp => {
                bp.AssetGuid = ModSettings.Blueprints.NewBlueprints["ArcanistExploitMetamagicKnowledge"];
                bp.name = "ArcanistExploitMetamagicKnowledge";
                bp.SetName("Metamagic Knowledge");
                bp.SetDescription("The arcanist can select one metamagic feat as a bonus feat. She must meet the prerequisites of this feat.");
                bp.m_AllFeatures = ShamanHexSecretSelection.m_AllFeatures;
                bp.Mode = SelectionMode.OnlyNew;
                bp.IsClassFeature = true;
            });
            Resources.AddBlueprint(ArcanistExploitMetamagicKnowledge);
            if (ModSettings.AddedContent.ArcanistExploits.DisableAll || !ModSettings.AddedContent.ArcanistExploits.Enabled["MetamagicKnowledge"]) { return; }
            ArcanistExploitSelection.m_AllFeatures = ArcanistExploitSelection.m_AllFeatures.AddToArray(ArcanistExploitMetamagicKnowledge.ToReference<BlueprintFeatureReference>());
        }
    }
}